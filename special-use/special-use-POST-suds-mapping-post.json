{
    "$schema": "http://json-schema.org/draft-04/schema#",
    "title": "Special use application",
    "description": "A rough sketch of the POST JSON HTTP request and corresponding basic SUDS API fields and endpoints for a special use permit application from the U.S. Forest Service ePermitting system",
    "definitions": {
      "applicant-info": {
        "type": "object",
        "properties": {
      		"firstName": { "type": "string", "basic-api-field" : "firstName", "basic-api-endpoint": "/contact/person", "required-by-basic-api": "no"},
      		"lastName": {	"type": "string", "basic-api-field" : "lastName", "basic-api-endpoint": "/contact/person", "required-by-basic-api": "yes" },
          "dayPhone": { "$ref": "#/definitions/phone-number" },
          "eveningPhone": { "$ref": "#/definitions/phone-number" },
          "emailAddress": { "type": "string", "basic-api-field" : "email", "basic-api-endpoint": "/contact-address", "required-by-basic-api": "no"},
          "mailingAddress": { "type": "string", "basic-api-field" : "address1", "basic-api-endpoint": "/contact-address", "required-by-basic-api": "yes"},
          "mailingAddress2": { "type": "string", "basic-api-field": "address2", "basic-api-endpoint": "/contact-address", "required-by-basic-api": "no"},
          "mailingCity": { "type": "string", "basic-api-field" : "cityName", "basic-api-endpoint": "/contact-address", "required-by-basic-api": "yes"},
          "mailingState": { "type": "string", "basic-api-field" : "stateCode", "basic-api-endpoint": "/contact-address", "required-by-basic-api": "yes"},
          "mailingZIP": { "type": "integer", "basic-api-field": "postalCode", "basic-api-endpoint": "/contact-address", "required-by-basic-api": "yes"},
      		"organizationName": {
      			"description": "The name of the group, company, organization or event applying",
      			"type": "string",
            "basic-api-field" : "contName",
            "basic-api-endpoint": "/contact/organization",
            "required-by-basic-api": "yes"
      		},
          "website": { "type": "string", "note" : "Store in middle layer." },
          "orgType": {
            "type": { "enum": [ "Association","Corporation","Education","Federal Government","State Government","Local Govt","Married Common Property","Limited Liability Company (LLC)","Limited Liability Corporation (LLP)","Trust" ] },
            "basic-api-field" : "orgType",
            "basic-api-endpoint": "/contact/organization",
            "required-by-basic-api": "yes" },
          "AUTOPOPULATED_BY_MIDDLEWARE_NOT_INTAKE_MODULE": { "basic-api-field": "countryName",
            "value" : "United States of America",
            "basic-api-endpoint": "/contact-address",
            "required-by-basic-api": "no"},
          "AUTOPOPULATED_BY_MIDDLEWARE_NOT_INTAKE_MODULE": {
            "basic-api-field": "contactID",
            "basic-api-endpoint": { "enum" : ["/contact-person", "/contact-organization"] },
            "note": "This field is deprecated, but has to be filled with something."
          },
      },
      "phoneNumber": {
        "type": "object",
        "properties": {
          "areaCode": { "type": "integer", "basic-api-field": "areaCode", "basic-api-endpoint": "/contact-phone"},
          "number": { "type": "integer", "basic-api-field": "phoneNumber", "basic-api-endpoint": "/contact-phone"},
          "extension": { "type": "integer", "basic-api-field": "extension", "basic-api-endpoint": "/contact-phone"},
          "type": { "basic-api-field" : "phoneNumber",
            "note" : "We should limit responses to a few options, even though SUDS does not.",
            "basic-api-endpoint": "/contact-phone"
          },
      "AUTOPOPULATED_BY_MIDDLEWARE_NOT_INTAKE_MODULE": { "basic-api-field": "securityId",
        "note" : "Concatenation of region, forest and district code",
        "basic-api-endpoint": "/contact-phone"
        },
        "AUTOPOPULATED_BY_MIDDLEWARE_NOT_INTAKE_MODULE": {
          "type": "string",
          "basic-api-field": "contact",
          "basic-api-endpoint": "/contact-phone",
          "note" : "This will be populated from the response of the /contact/person or /contact/organization POST request."
        },
        },
        "required-by-basic-api": ["number","type", "securityId", "contact"]
      },
      "non-commercial-fields": {
        "type": "object",
        "properties": {
      		"activityDescription": { "type": "string", "note" : "Store in middle layer."},
      		"locationDescription": {	"type": "string", "note" : "Store in middle layer."},
          "startDateTime": { "type": "dateTime", "note" : "Store in middle layer."},
          "endDateTime": { "type": "dateTime", "note" : "Store in middle layer." },
          "numberParticipants" : { "type": "integer", "note" : "Store in middle layer." },
          "AUTOPOPULATED_BY_MIDDLEWARE_NOT_INTAKE_MODULE": { "basic-api-field": "PURPOSE",
            "note" : "This field should be a concatenation of activityDescription, locationDescription, startDateTime, endDateTime."},
          "AUTOPOPULATED_BY_MIDDLEWARE_NOT_INTAKE_MODULE": {
            "basic-api-field": "FORM_NAME",
            "value" : "FS-2700-3b",
            "basic-api-endpoint": "/contact/application",
            "required-by-basic-api": "Y"},
          },
      },
      "temp-outfitter-fields": {
        "type": "object",
        "properties": {
          "individualIsCitizen" : { "type" : "boolean", "note" : "Required if orgType is individual. Stored in the middlelayer."},
          "smallBusiness" : { "type" : "boolean", "note" : "Required if orgType is not individual. Stored in the middlelayer."},
          "activityDescription": { "type": "string", "note": "Stored in the middlelayer.", "basic-api-field": "PURPOSE"},
          "advertisingURL": { "type": "URL", "note" : "Either advertisingURL or advertisingDescription must be complete. Stored in the middlelayer."},
          "advertisingDescription": { "type": "string", "note" : "Either advertisingURL or advertisingDescription must be complete. Stored in the middlelayer."},
          "clientCharges": { "type": "string", "note": "Stored in the middlelayer."},
          "experienceList": { "type": "string", "note": "Stored in the middlelayer."},
          "guideDocumentation": {
            "type": "file",
            "note": "Stored in the middle layer.",
          },
          "acknowledgementOfRiskForm": {
            "type": "file",
            "note": "Stored in the middle layer.",
          },
      		"insuranceCertificate": {
            "type": "file",
            "note": "Stored in the middle layer.",
          },
          "goodStandingEvidence": {
      			"description": "Certificate of good standing, operating agreement, or other evidence the business is in good standing",
            "note": "Stored in the middle layer.",
            "type": "file"
          },
          "operatingPlan": {
      			"description": "A completed Word or RTF operating plan template.",
            "note": "Stored in the middle layer.",
            "type": "file"
          },
          "AUTOPOPULATED_BY_MIDDLEWARE_NOT_INTAKE_MODULE": { "basic-api-field": "FORM_NAME", "value" : "FS-2700-3f"},
         "required-by-basic-api": ["orgType","insuranceCertificate","goodStandingEvidence","operatingPlan"]
      },
    },
    "type": "object",
    "properties": {
      "region": { "type" : "integer", "note" : "Store in middle layer."},
      "forest": { "type" : "integer", "note" : "Store in middle layer." },
      "district": { "type" : "integer", "note" : "Store in middle layer."},
      "applicant-info" : {
        "oneOf" : [
          { "$ref": "#/definitions/applicant-info" },
          { "contact-id": { "type" : "integer" , "basic-api-field" : "contCN" } }
        ]
      },
      "type" : { "enum" : ["non-commercial","temp-outfitter-guide"],
        "note" : "See the FORM_NAME fields in the blocks specific to each permit type. Will not be passed directly to basic api."},
      "type-specific-fields": {
        "oneOf": [
          { "$ref": "#/definitions/non-commercial-fields" },
          { "$ref": "#/definitions/temp-outfitter-fields" },
        ]
      },
      "AUTOPOPULATED_BY_MIDDLEWARE_NOT_INTAKE_MODULE": { "basic-api-field": "securityId", "note" : "Concatenation of region, forest and district code",
        "basic-api-endpoint": ["/application", "/contact-address", "/contact-phone"],
        "required-by-basic-api": "Y"},
      "AUTOPOPULATED_BY_MIDDLEWARE_NOT_INTAKE_MODULE": { "basic-api-field": "managingOrg",
        "note" : "Concatenation of region, forest and district code",
        "basic-api-endpoint": "/application",
        "required-by-basic-api": "Y"},
      "AUTOPOPULATED_BY_MIDDLEWARE_NOT_INTAKE_MODULE": { "basic-api-field": "adminOrg",
        "note" : "Concatenation of region, forest and district code",
        "basic-api-endpoint": "/application",
        "required-by-basic-api": "Y"},
      "AUTOPOPULATED_BY_MIDDLEWARE_NOT_INTAKE_MODULE": { "basic-api-field": "ePermitID",
        "note" : "Generate an ID number that starts with forest alphacode, followed by five 0s, and then an incrementing number. ",
        "basic-api-endpoint": "/application",
        "required-by-basic-api": "Y"},
      "AUTOPOPULATED_BY_MIDDLEWARE_NOT_INTAKE_MODULE": { "basic-api-field": "acres",
          "note" : "Value should always be 0",
          "basic-api-endpoint": "/application",
          "required-by-basic-api": "Y"}         },
      "AUTOPOPULATED_BY_MIDDLEWARE_NOT_INTAKE_MODULE": { "basic-api-field": "contCN",
          "note" : "If there is no matching contact, included in the response to the /contact/person or /contact/organization endpoint. If there is a pre-existing contact, should be contact-id field above.",
          "basic-api-endpoint": "/application",
          "required-by-basic-api": "Y"}         },
}
